# Polar Flow Export
Bookmarklet for exporting your Polar Flow data.

Drag the bookmarklet below to your bookmarks:
<a href="javascript:(function(e,a,g,h,f,c,b,d){if(!(f=e.jQuery)||g&gt;f.fn.jquery||h(f)){c=a.createElement(&quot;script&quot;);c.type=&quot;text/javascript&quot;;c.src=&quot;http://ajax.googleapis.com/ajax/libs/jquery/&quot;+g+&quot;/jquery.min.js&quot;;c.onload=c.onreadystatechange=function(){if(!b&amp;&amp;(!(d=this.readyState)||d==&quot;loaded&quot;||d==&quot;complete&quot;)){h((f=e.jQuery).noConflict(1),b=1);f(c).remove()}};a.documentElement.childNodes[0].appendChild(c)}})(window,document,&quot;1.10.2&quot;,function($,L){!function(){function e(e){$(&quot;#polar-flow-export&quot;).remove();var t=$('&lt;div id=&quot;polar-flow-export&quot;&gt;&lt;/div&gt;');t.css({position:&quot;fixed&quot;,width:&quot;100%&quot;,height:&quot;100%&quot;,top:0,left:0,zIndex:9999,background:&quot;white&quot;,padding:&quot;0 40px&quot;}).appendTo($(&quot;body&quot;)),$(&quot;&lt;h1&gt;Export Polar flow data&lt;/h2&gt;&quot;).val(&quot;foobar&quot;).appendTo(t),e?($(&quot;&lt;p&gt;You may now copy-paste the information below to a spreadsheet program (such as Excel or Google Spreadsheet).&lt;/p&gt;&quot;).appendTo(t),$(&quot;&lt;textarea&gt;&lt;/textarea&gt;&quot;).css({width:&quot;90%&quot;,height:300}).val(e).appendTo(t)):$(&quot;&lt;img /&gt;&quot;).attr(&quot;src&quot;,&quot;http://cdnjs.cloudflare.com/ajax/libs/galleriffic/2.0.1/css/loader.gif&quot;).appendTo(t),$(&quot;&lt;br/&gt;&quot;).appendTo(t),$('&lt;button class=&quot;button&quot; type=&quot;button&quot;&gt;Close&lt;/button&gt;').css({fontSize:&quot;20px&quot;}).click(function(){t.remove()}).appendTo(t)}function t(e){function t(e){return(&quot;00&quot;+e).slice(-2)}var o=/(\d+) hours? (\d+) minutes/g,a=o.exec(e);return a&amp;&amp;3===a.length?[t(a[1]),t(a[2]),&quot;00&quot;].join(&quot;:&quot;):null}function o(){var e=&quot;https://flow.polar.com/diary&quot;;if(0===window.location.href.indexOf(e))return!0;var t=confirm([&quot;You are not on correct page for export. Redirect to Polar Flow Diary?&quot;,&quot;&quot;,&quot;NOTE: You must re-run bookmarklet on that page.&quot;].join(&quot;\n&quot;));return t?(window.location=e,!1):!1}function a(o,a){var i=a.diff(o,&quot;days&quot;),l=_.reduce(_.range(0,i+1),function(e,t){return e.push(moment(o).add(t,&quot;d&quot;)),e},[]),p=(new Date).getTime(),s=_.map(l,function(e){var o=e.format(r),a=[&quot;https://flow.polar.com/activity/summary/&quot;,o,&quot;/&quot;,o,&quot;/day?_=&quot;,p].join(&quot;&quot;);return $.get(a).then(function(o){var a=$(&quot;&lt;div&gt;&quot;+o+&quot;&lt;/div&gt;&quot;),n=a.find(&quot;.sleep-tracked-icon-image:eq(0) &gt; span&quot;),r=a.find(&quot;.sleep-tracked-icon-image:eq(1) .value-huge&quot;).text(),i=a.find(&quot;.steps-icon-image .value-huge&quot;).text(),l=a.find(&quot;.distance-icon-image .value-huge&quot;).text(),p=a.find(&quot;.calories-icon-image .value-huge&quot;).text();return i&amp;&amp;parseInt(i)&gt;0?{day:e,data:{totalSleep:t(n.eq(0).text()),restfulSleep:t(n.eq(2).text()),restlessSleep:t(n.eq(3).text()),restfulSleepPercentage:r,stepCount:i,distance:l,kcal:p}}:null})});e(null),$.when.apply($,s).then(function(){var t=[&quot;Day&quot;,&quot;Steps&quot;,&quot;Distance&quot;,&quot;Calories (kcal)&quot;,&quot;Total sleep&quot;,&quot;Restful sleep&quot;,&quot;Restless sleep&quot;,&quot;Restful sleep %&quot;].join(&quot;	&quot;),o=_.reduce(_.compact(arguments),function(e,t){var o=t.data;return e.push([t.day.format(n),o.stepCount,o.distance,o.kcal,o.totalSleep,o.restfulSleep,o.restlessSleep,o.restfulSleepPercentage].join(&quot;	&quot;)),e},[t]);e(o.join(&quot;\n&quot;))})}var n=&quot;YYYY-MM-DD&quot;,r=&quot;D.M.YYYY&quot;;!function(){if(o()){var e=moment().add(-7,&quot;d&quot;).format(n),t=prompt(&quot;Give either start day of export (e.g. &quot;+e+&quot;) or number of days from now to export (e.g. 7)&quot;,&quot;7&quot;),r=moment(t,n);if(r.isValid()){e=moment().format(n);var i=prompt(&quot;Give end day of export (e.g. &quot;+e+&quot;)&quot;,e),l=moment(i,n);l.isValid()?a(r,l):alert(&quot;Invalid input.&quot;)}else/^\d+$/gi.test(t)?a(moment().subtract(parseInt(t),&quot;d&quot;),moment()):alert(&quot;Invalid input.&quot;)}}()}();});">Polar Flow Export (bookmarklet)</a>
