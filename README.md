# Polar Flow Export
Bookmarklet for exporting your Polar Flow data.

### Installation
Create a bookmark with following content:
```javascript
javascript:(function(e,a,g,h,f,c,b,d){if(!(f=e.jQuery)||g>f.fn.jquery||h(f)){c=a.createElement("script");c.type="text/javascript";c.src="http://ajax.googleapis.com/ajax/libs/jquery/"+g+"/jquery.min.js";c.onload=c.onreadystatechange=function(){if(!b&&(!(d=this.readyState)||d=="loaded"||d=="complete")){h((f=e.jQuery).noConflict(1),b=1);f(c).remove()}};a.documentElement.childNodes[0].appendChild(c)}})(window,document,"1.10.2",function($,L){!function(){function%20e(e){$("#polar-flow-export").remove();var%20t=$('<div%20id="polar-flow-export"></div>');t.css({position:"fixed",width:"100%",height:"100%",top:0,left:0,zIndex:9999,background:"white",padding:"0%2040px"}).appendTo($("body")),$("<h1>Export%20Polar%20flow%20data</h2>").val("foobar").appendTo(t),e?($("<p>You%20may%20now%20copy-paste%20the%20information%20below%20to%20a%20spreadsheet%20program%20(such%20as%20Excel%20or%20Google%20Spreadsheet).</p>").appendTo(t),$("<textarea></textarea>").css({width:"90%",height:300}).val(e).appendTo(t)):$("<img%20/>").attr("src","http://cdnjs.cloudflare.com/ajax/libs/galleriffic/2.0.1/css/loader.gif").appendTo(t),$("<br/>").appendTo(t),$('<button%20class="button"%20type="button">Close</button>').css({fontSize:"20px"}).click(function(){t.remove()}).appendTo(t)}function%20t(e){function%20t(e){return("00"+e).slice(-2)}var%20o=/(\d+)%20hours?%20(\d+)%20minutes/g,a=o.exec(e);return%20a&&3===a.length?[t(a[1]),t(a[2]),"00"].join(":"):null}function%20o(){var%20e="https://flow.polar.com/diary";if(0===window.location.href.indexOf(e))return!0;var%20t=confirm(["You%20are%20not%20on%20correct%20page%20for%20export.%20Redirect%20to%20Polar%20Flow%20Diary?","","NOTE:%20You%20must%20re-run%20bookmarklet%20on%20that%20page."].join("\n"));return%20t?(window.location=e,!1):!1}function%20a(o,a){var%20i=a.diff(o,"days"),l=_.reduce(_.range(0,i+1),function(e,t){return%20e.push(moment(o).add(t,"d")),e},[]),p=(new%20Date).getTime(),s=_.map(l,function(e){var%20o=e.format(r),a=["https://flow.polar.com/activity/summary/",o,"/",o,"/day?_=",p].join("");return%20$.get(a).then(function(o){var%20a=$("<div>"+o+"</div>"),n=a.find(".sleep-tracked-icon-image:eq(0)%20>%20span"),r=a.find(".sleep-tracked-icon-image:eq(1)%20.value-huge").text(),i=a.find(".steps-icon-image%20.value-huge").text(),l=a.find(".distance-icon-image%20.value-huge").text(),p=a.find(".calories-icon-image%20.value-huge").text();return%20i&&parseInt(i)>0?{day:e,data:{totalSleep:t(n.eq(0).text()),restfulSleep:t(n.eq(2).text()),restlessSleep:t(n.eq(3).text()),restfulSleepPercentage:r,stepCount:i,distance:l,kcal:p}}:null})});e(null),$.when.apply($,s).then(function(){var%20t=["Day","Steps","Distance","Calories%20(kcal)","Total%20sleep","Restful%20sleep","Restless%20sleep","Restful%20sleep%20%"].join(""),o=_.reduce(_.compact(arguments),function(e,t){var%20o=t.data;return%20e.push([t.day.format(n),o.stepCount,o.distance,o.kcal,o.totalSleep,o.restfulSleep,o.restlessSleep,o.restfulSleepPercentage].join("")),e},[t]);e(o.join("\n"))})}var%20n="YYYY-MM-DD",r="D.M.YYYY";!function(){if(o()){var%20e=moment().add(-7,"d").format(n),t=prompt("Give%20either%20start%20day%20of%20export%20(e.g.%20"+e+")%20or%20number%20of%20days%20from%20now%20to%20export%20(e.g.%207)","7"),r=moment(t,n);if(r.isValid()){e=moment().format(n);var%20i=prompt("Give%20end%20day%20of%20export%20(e.g.%20"+e+")",e),l=moment(i,n);l.isValid()?a(r,l):alert("Invalid%20input.")}else/^\d+$/gi.test(t)?a(moment().subtract(parseInt(t),"d"),moment()):alert("Invalid%20input.")}}()}();});
```
